{{ if not hugo.IsServer }}
<script async defer data-domain="nonsense.fyi" src="https://hosted.roxedus.net/js/script.outbound-links.js"></script>
<script>
    getCurrentVisitors().then(showCurrentVisitors)
    setInterval(() => getCurrentVisitors().then(showCurrentVisitors), 10000)

    function showCurrentVisitors(currentVisitors = 0) {
        const container = document.getElementById('current-visitors-container')
        if (!container) return console.info('no container to show current visitors found')
        container.innerHTML = `
    <a aria-hidden tabindex="-1" href="https://views.roxedus.net/nonsense.fyi" rel="nofollow noopener external" target="_blank">
        ${currentVisitors}&nbsp;<svg width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 5a2 2 0 1 1-4 0 2 2 0 0 1 4 0zM8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm6 5c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/></svg>
    </a>
    `.trim()
    }

    function getCurrentVisitors() {
        return window.fetch('https://current-visitors.nonsense.fyi/')
            .then((res) => res.text())
    }
</script>
{{ end }}